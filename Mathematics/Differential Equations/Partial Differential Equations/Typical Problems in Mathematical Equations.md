# 说明
下面根据期末考试的要求列出几个应知应会的典型问题。
# 求解非本征值问题
就像非静电力不能简单理解成静电力以外的所有力（也要对电荷起作用），非电解质不能简单理解成电解质以外的物质（也要是化合物）一样，我所谓的非本征值问题，也和本征值有关。
* 本征值问题，决定本征值的取值
* 非本征值问题，本征值给定，求解方程
* 它的结果和本征值问题的本征函数，一一匹配（通过相同的本征值），乘在一起，再求和，构成了PDE定解问题，各项变量分离的级数解。

另外一个方面，通常本征函数做基底（空间上），它的系数是非本征值问题的解（时间上/剩余空间维度）。而非本征值问题自身，也有基底和系数的概念。

非本征值问题的解，是解式在本征函数基底展开式下的系数。这里的系数是指“与空间无关”，但却是“时间的函数”。

非本征值问题，也存在自身的基底（齐次通解的基底），以及系数（标量系数）。

通常所谓的“叠加系数”指的是上面说的“标量系数”，那么这个“标量系数”总是紧紧跟着非本征值问题的解的，而不是紧跟着本征函数（尤其是本征函数具有简并现象的时候，要特别注意）。

总之，非本征值问题和本征值问题同等重要，都是微分方程，都和本征值联系紧密，都是定解问题的重要组成部分。

常见的非本征值问题的微分方程有如下几种：
* 指数方程
  * 常见于耗散方程的时间部分
* 三角方程
  * 常见于波动方程的时间部分
* 双曲三角方程
  * 常见于Laplace方程，矩形边界，的剩余边界部分
* Euler方程
  * 注意当本征值取 $0$ 的时候，含有对 $t=\ln r$ 的一次函数，也就是含有对数项。
  * 常见于Laplace方程，圆形边界，的径向部分： $r\frac{d}{dr}r\frac{d}{dr}=\frac{d^2}{dt^2}$ 
    *  Laplace的定解问题，完全可以不涉及Bessel和球Bessel函数
    *  因为角度方向本征函数的简并现象，以及非本征值问题也是两个基底
    *  所以比较系数会得到二元的线性代数方程组
       *  可以通过伴随矩阵法求逆矩阵，方便确定系数
  * 常见于Laplace方程，球形边界，的径向部分： $\frac{d}{dr}r^2\frac{d}{dr}=\frac{d^2}{dt^2}+\frac{d}{dt}$
    * Laplace的定解问题，完全可以不涉及Bessel和球Bessel函数
    * 但是径向上，涉及Legendre函数是很有可能的
  
* Bessel方程
  * 常见于Helmholtz方程，圆形边界，的径向部分
    * 其实当波动方程和耗散方程，边界条件齐次的时候，根本不会涉及这个情况
    * 那时，整个Helmholtz方程构成了一个三元本征值问题（方程齐次，边界条件全部齐次）
    * 径向的非本征值问题，也变成了本征值问题
    * 定解问题中的非本征值问题，全部集中在了时间部分。
* 球Bessel方程
  * 常见于Helmholtz方程，球形边界，的径向部分
    * 其实当波动方程和耗散方程，边界条件齐次的时候，根本不会涉及这个情况
    * 那时，整个Helmholtz方程构成了一个三元本征值问题（方程齐次，边界条件全部齐次）
    * 径向的非本征值问题，也变成了本征值问题
    * 定解问题中的非本征值问题，全部集中在了时间部分。

# 求解本征值问题
## 本征值问题的重要意义
级数解法的精髓在于将解式与所有的定解条件都展开成级数。而所谓的展开，用线性代数的观点来看，就是向量在一组基底下的分解。

基底选的好，是最重要的。

### 基底要完备
这是说，对于任何一个向量，现有的基底可以把它“准确”展开。当然，所谓的“准确”建立在一种范数的定义上。

有了这一点，联系线性代数里面的观点，向量在基底下的表示具有唯一性。那么就可以比较系数了。系数相等，则向量相等。

回顾一下线性代数里面“向量，基底，坐标（展开系数）”三者的密切联系。

给定向量与给定基底加坐标（展开系数）是等价的。

### 基底最好正交
正交的基底为确定系数（坐标）提供了方便的路径，那就是通过内积运算算坐标。

关于这一点，线性代数里面讲过所谓确定Fourier系数的办法。那里的Fourier系数和相应的展开式，就是广义的Fourier展开。也就是向量在一组正交基底下的展开

### 对于一个微分方程，基底还必须是本征函数
偏微分方程的特点就是含有微分算子。为了级数解法的思想（在一组基底下展开，逐项匹配系数）顺利实施，应该要求基底在微分算符的作用下具有一定的不变性。

也就是说，微分算符作用于基底，还应该是原来那个基底，至多差一个常数倍。

这样，基底以一个常数的代价，顺利地“穿过”非分算符，微分算符的作用全部作用在了非本征值问题中的单一变量上。

这样的基底是什么？

就是特征向量！

是谁的特征向量？

是微分算符的特征向量

谁是线性映射？

微分算符经过变量分离之后的形式。

定义在哪个线性空间上？

齐次边界条件约束的Hilbert空间的线性子空间

再回过头来说比较系数。这就是刚才说的“非本征值问题”。匹配系数的过程，就是解一系列形式相同的ODE。之所以是ODE就是因为多维的微分算符作用在本征函数上“失效”，所有真正的“微分”全都作用在了一个变量上。对于本征函数基底组，这个变量是系数。对于这个变量自身，这是一个ODE微分方程。

举个例子吧

$$
\frac{\partial^2}{\partial^2t}u_n-c^2\nabla^2u_n
$$

$$
u_n=T_nw_n
$$

其中 $w_n$ 是基底，而且是本征函数，是Helmholtz方程的本征函数，换言之：

$$
\nabla^2w_n=-k_n^2w_n
$$

所以有：

$$
\nabla^2(T_nw_n)=T_n\nabla^2 w_n=T_n(-k_n^2)w_n=-k_n^2T_nw_n
$$

### 都是为了寻找这样好的基底
为了找这样好的基底，我们分离变量构造本征值问题（线性空间，线性映射）。在直角/球/柱系下，半径/角度等不同维度上，产生了多种多样的本征值问题。它们的解，也就是本征函数，我们希望作为基底的那些函数，包括三角函数，Legendre函数，Bessel函数，球Bessel函数等等。

### 初学与应用
在求解PDE定解问题的时候（应用），不妨把Helmholtz的本征函数作为既定结论（封装好的黑盒子）拿来用就好了。三元的本征函数可以看作，三角、Legendre、球Bessel函数的乘积（球边界）或者三角、Bessel函数的乘积（圆边界）。

但是第一次学的时候，应该搞清楚，这些三个一元的本征函数分别来自，变量分离构成的三个本征值问题（通过ODE边值问题有解的约束，确定本征值的离散取值，以及对于本征函数）。三个一元的本征函数乘在一起，构成了一个三元的本征函数。
## 构成本征值问题的要素
* 齐次边界条件：约束了一个线性空间/线性子空间
* 齐次方程：定义了一个线性映射/线性微分算符
* 我们遇到的线性映射通常是自伴的，因而特征向量/本征函数有以下特性：
  * 分属不同特征值的特征子空间的特征向量是彼此正交的
  * 还可以证明在Hilbert空间中，平方收敛意义下是完备的
  * 彼此正交的、完备的的特征值/本征函数基底组，是展开以后，逐项比较系数的理论依据。
## 求解思路概述
* 本征值问题的求解，往往归结到一个变量的ODE边值问题
  * 当然这和一般的边值问题是不一样的
  * 区别在于方程不是唯一确定的
  * 而是为了使得边值问题有解，从而修正/取方程系数的个别值
* ODE边值问题的解，不像初值问题的解。
  * 初值问题的解存在且唯一
  * 边值问题可能无解
* 正是因为边值问题可能无解，所以才能把本征值从连续取值，约束称为离散取值。因为这样才能保住构成的边值问题有解。
## 三角函数的本征值问题
* 第一二三类齐次边界条件条件
  * 注意扇形区域（Laplace或者Helmholtz）的角度部分，不再满足周期性边界条件，本征函数的样式与扇形区域的角度还有关系。与此同时，也就没有本征函数的简并现象了。
* 周期性齐次边界条件
  * 会有简并现象
  * 本征值是通过零行列式为零得到的
  * 最好能直接记下来结论，不然推导过程相当繁琐。
  * 这个本征值问题在很多个地方出现
    * 球 Helmholtz 的 $\phi$ 方向
    * 球 Laplace 的 $\phi$ 方向
    * 柱 Helmholtz 的 $\theta$ 方向
    * 柱 Laplace 的 $\theta$ 方向
    * 圆 Laplace 的 $\theta$ 方向
    * 其实归根结底，都是与 $x$ 轴夹角（向 $xy$ 平面投影后）方向上的方程，满足这个周期性边界条件，以及相应的三角函数的本征值问题。
## 连带 Legendre 函数的本征值问题
这个关键在于把方程的形式，和解的对应关系记准确。

其中一个本征值涉及 $m$ 已经由三角函数的本征值问题求出（ $\phi$ 方向）。余下的一个本征值涉及 $l$ 需要在这里求出。

具体 $l$ 求出的办法，是为了截断 Legendre 函数，使之称为多项式，从而有界得出的。
## Bessel 函数的本征值问题
这个的关键也在于把方程的形式和解的对应关系记准确。

其中一个本征值涉及 $m$ 已经由三角函数的本征值问题求出。
## 球 Bessel 函数的本征值问题
要把方程形式和解的对应关系记准确。
> 注意上面这三个本征值问题有一个共性，一个本征值问题涉及到两个本征值。其中一个本征值属于另外一个本征值问题，已经确定。余下的一个本征值属于这个问题，需要求出。
# 含特殊函数的积分
这部分的主要内容，已经系统性地在关于PDE级数解法(Series Solutions of PDEs)的文档里讨论过了。
## Bessel 函数
### 无穷积分
* 零阶Bessel函数的无穷积分

$$
\mathscr{L}\{J_0(\omega x)\}=\frac{1}{\sqrt{p^2+\omega^2}}
$$

上面的结果有两种方式可以得出：
* 使用Bessel函数的级数表达式，交换积分与求和次序
  * 求和的时候反向利用Taylor展开式
* 使用Bessel函数的复指数积分表达式，交换二重积分的次序
  * 外层积分的时候，利用留数定理求解

一般而言，无穷积分只有零阶Bessel函数比较好处理。

### 利用递推式做最终化简

$$
J_{\nu-1}-J_{\nu+1}=2J_{\nu'}
$$

这个公式告诉我们，涉及Bessel函数的导数，都可以化解掉（不含导数的形式）

$$
J_{\nu-1}+J_{\nu+1}=2\frac{\nu}{x}J_{\nu}
$$

这个公式告诉我们，Bessel函数满足二阶递推。所有阶次都可以用 $J_0,J_1$ 表示。

换而言之，任何阶数的Bessel函数，及其一阶导数，都可以用 $J_0,J_1$ 表示。

# ODE Green函数的求解
* 推荐使用Laplace变换法
  * 要特别注意逆变换含有 $\eta(x)$ 
  * 对于边值问题，需要待定一阶导数的初值
* 不适合用Laplace变换法，就去分类讨论吧
  * 单纯求解Green函数一般都是适合的
  * 即便方程非齐次项不方便Laplace变换，也不影响Green函数的求解使用Laplace变换
# ODE的求解
常见的方法与使用条件如下：
* 常数变易法
  * 针对方程具有非齐次项的情况
* Laplace变换法
  * 常系数就很好用
* Green函数法
  * 齐次定解条件很好用
    * 方程非齐次，定解条件齐次是Green函数法擅长之处
  * 非齐次定解条件也能用
  * 求解Green函数也可以用Laplace
    * 无论是边值问题还是初值问题

# PDE的求解
## PDE定解问题的要素
* 方程
  * 左端形式：波动、耗散、稳定
  * 方程右端齐次与否
* 边界
  * 边界形状
  * 边界条件齐次与否
* 初始条件/剩余边界条件齐次与否
* 对称性
  * 给出的定解条件缺少的变量具有对称性
  * 这样的变量不出现在解式中
  * 也不出现在本征函数组中，对应的本征值取 $0$ 
  
这几个方面的不同组合，构成了常见的PDE定解问题类型。不是所有的类型都可以很容易的求解，适合在考场上限时完成的只占一部分。

## 方法选取
在方法选取上，本次考试考查积分变换法和分离变量法。
### 积分变换法
典型的积分变换法的使用情景如下：
* 包含一个主要空间维度，和一个时间维度/剩余空间维度
* 对于主要空间维度，边界无界，可以使用Fourier变换
* 对于时间维度，没有什么限制

对于时间空间的变换使用要求如下：
* Laplace变换对时间做，对于空间、时间没有任何要求
  * 边界可以有界，也可以无界
  * 边界可以齐次，也可以非齐次
  * 初始条件可以齐次，也可以非齐次
  * 方程可以齐次，也可以非齐次
  * 非齐次的方程和初始条件，都将转移到关于空间的ODE的方程非齐次项中去。
  * 非齐次的边界条件，就是变换后ODE定解条件的非齐次
  * 对于方程的非齐次项，边界条件都要做变换
* Fourier变换对空间做，要求较高
  * 边界要无界，并且齐次（无界默认齐次）
  * 对于方程的非齐次项和初始条件没有要求
  * 对于初始条件和方程的非齐次项都要做变换

### 级数解法

级数解法关键在于找到本征函数，而求解本征值问题首先需要齐次边界条件约束出一个线性子空间，作为线性映射的定义域。

级数解法视角下，面对方程的非齐次项（右端）和初始条件/剩余边界条件，处理方法是一致的，都是先展开，再逐项匹配系数。只不过，通过PDE方程匹配系数得到一系列ODE，通过初始条件/剩余边界条件匹配系数，得到一些列代数方程。而后者恰好为一系列ODE提供了定解条件。

因而掌握级数解法的思路关键在于：
* 根据方程的形式和边界形状，明确区分本征值问题和非本征值问题涉及的变量
* 如果非齐次边界条件构成阻碍，那么要想办法把它齐次化，尽量同时齐次化
* 根据初始条件、边界条件所涉及的变量，判断对称性，删减本征函数
* 得到本征函数后对方程的右端，以及初始条件/剩余边界条件做展开
* 展开后匹配系数，相当于求解一系列ODE的定解问题（非本征值问题）

#### 常见的各种PDE定解问题及本征函数的选取与化简
我把这个思路汇总在下面的表格中

|方程形式|边界形状|定解条件涉及的变量|本征函数涉及的变量|本征函数形式|非本征值问题涉及的变量|相应解的形式|
|-|-|-|-|-|-|-|
|Laplace|矩形| $x,y$ | $x$ |三角函数| $y$ |双曲三角函数|
|Laplace|圆形| $r,\theta$ | $\theta$ |三角函数（简并）| $r$ |指数函数（源自Euler方程）|
|Laplace|球形| $r,\theta,\phi$ | $\theta,\phi$ |球谐函数：<br> $P_l^m$ <br>与<br>三角函数（简并）| $r$ |指数函数（源自Euler方程）|
|Laplace|球形| $r,\theta$ | $\theta$ |$P_l$ | $r$ |球Bessel函数|
|波动方程|直线| $x,t$ | $x$ |三角函数| $t$ |三角函数|
|波动方程|矩形| $x,y,t$ | $x,y$ |三角函数与三角函数| $t$ |三角函数|
|波动方程|圆形| $r,\theta,t$ | $r,\theta$ |作为本征值的Bessel函数<br>与<br>三角函数（简并）| $t$ |三角函数|
|波动方程|圆形| $r,t$ | $r$ |作为本征值的零阶Bessel函数<br>| $t$ |三角函数|
|波动方程|球形| $r,\theta,\phi,t$ | $r,\theta,\phi$ |作为本征值的Bessel球函数<br>与<br> $P_l^m$ <br>与<br>三角函数（简并）| $t$ |三角函数|
|波动方程|球形| $r,\theta,t$ | $r,\theta$ |作为本征函数的Bessel球函数<br>与<br> $P_l$ | $t$ |三角函数|
|波动方程|球形| $r,t$ | $r$ |作为本征值的零阶球Bessel函数| $t$ |三角函数|
|耗散方程|直线| $x,t$ | $x$ |三角函数| $t$ |指数衰减|
|耗散方程|矩形| $x,y,t$ | $x,y$ |三角函数与三角函数| $t$ |指数衰减|
|耗散方程|圆形| $r,\theta,t$ | $r,\theta$ |作为本征函数的Bessel函数<br>与<br>三角函数（简并）| $t$ |指数衰减|
|耗散方程|圆形| $r,t$ | $r$ |作为本征函数的零阶Bessel函数| $t$ |指数衰减|
|耗散方程|球形| $r,\theta,\phi,t$ | $r,\theta,\phi$ |作为本征函数的Bessel球函数<br>与<br> $P_l^m$ <br>与<br>三角函数（简并）| $t$ |指数衰减|
|耗散方程|球形| $r,\theta,t$ | $r,\theta$ |作为本征函数的Bessel球函数<br>与<br> $P_l$ | $t$ |指数衰减|
|耗散方程|球形| $r,\phi,t$ | $r,\phi$ |作为本征函数的零阶Bessel球函数<br>与<br>三角函数（简并）| $t$ |指数衰减|



总结一下，单纯从本征函数选取来看：
* 波动方程与耗散方程没有区别
  * 都是Helmholtz的本征值问题
  * 球形边界，与 $\phi$ 无关，则
    * $m=0$
    * $\theta$ 方向由连带Legendre函数简化为Legendre多项式
  * 球形边界，与 $\theta$ 无关，则
    * $l=0$
    * $r$ 方向作为本征函数的球Bessel函数只取零阶 
  * 球形边界，只与 $r$ 有关，则
    * $l=m=0$
    * 本征函数是一元的，作为本征函数的零阶球Bessel函数
  * 圆形边界，与 $\theta$ 无关，则
    * $m=0$
    * $r$ 方向只取作为本征函数的零阶Bessel函数
* 方程齐次与非齐次没有区别
  * 基底，也就是本征函数选取没有区别
  * 但是展开的对象变多了，工作量变大了
  * 匹配系数得到的ODE也变成非齐次了
* Laplace方程与波动方程/耗散方程的径向部分的角色区别很大
  * Laplace径向/剩余边界不对应本征函数
    * 对于矩形区域，剩余边界的解是双曲三角函数
    * 对于圆形区域，径向的解是指数函数（Euler方程）
    * 对于球形区域，径向的解是指数函数（Euler方程）
    * 这些都是“非本征值问题”
    * 相当于波动方程和耗散方程的时间部分
  * 波动方程与耗散方程，空间变量全都对应本征函数
    * 而波动方程和耗散方程的时间部分是“非本征值问题”
    * 一个的解是三角函数
    * 另一个是指数衰减
#### 一言以蔽之
关于级数解法处理含时间的波动方程和耗散方程，我把关于分离时间变量的部分写在下面
##### 波动方程

$$
\frac{\partial^2}{\partial^2t}u-c^2\nabla^2u=f(\vec{r},t)
$$

###### 各项变量分离形式的 级数解

$$
u(\vec{r},t)=\sum_n u_n(\vec{r},t)=\sum_n w_n(\vec{r})T_n(t)
$$

###### 空间维度
空间维度是一系列本征值问题

$$
\nabla^2w_n(\vec{r})+k_n^2w_n(\vec{r})=0
$$

$$
w_n(\vec{r})\text{ 的齐次边界条件}
$$

得到的本征函数作为基底，展开PDE定解条件中的非齐次项（方程的非齐次项与初始条件的非齐次项）

###### 时间维度
时间维度是一系列非本征值问题

$$
T''_n(t)+\omega_n^2T_n(t)=f_n(t)
$$

$$
T_n(0),T_n'(0)
$$

利用本征函数作为基底，对PDE方程的非齐次项展开，匹配系数，得到一系列ODE方程的非齐次项。

利用本征函数作为基底，对PDE初始条件展开，匹配系数，得到一系列ODE初值。

###### 时空联系
本征值问题与非本征值问题通过本征值联系起来，下面的关系非常重要,也是与耗散方程的重要区别：

$$
\omega_n=k_nc
$$

##### 耗散方程

$$
\frac{\partial}{\partial t}u-D\nabla^2u=f(\vec{r},t)
$$

###### 各项变量分离形式的 级数解

$$
u(\vec{r},t)=\sum_n u_n(\vec{r},t)=\sum_n w_n(\vec{r})T_n(t)
$$

###### 空间维度
空间维度是一系列本征值问题（和波动方程一样，都是Helmholtz方程的本征值问题）

$$
\nabla^2w_n(\vec{r})+k_n^2w_n(\vec{r})=0
$$

$$
w_n(\vec{r})\text{ 的齐次边界条件}
$$

得到的本征函数作为基底，展开PDE定解条件中的非齐次项（方程的非齐次项与初始条件的非齐次项）


###### 时间维度
时间维度是一系列非本征值问题

$$
T'_n(t)+\alpha_n T_n(t)=f_n(t)
$$

$$
T_n(0)
$$

利用本征函数作为基底，对PDE方程的非齐次项展开，匹配系数，得到一系列ODE方程的非齐次项。

利用本征函数作为基底，对PDE初始条件展开，匹配系数，得到一系列ODE初值。

###### 时空联系
本征值问题与非本征值问题通过本征值联系起来，下面的关系非常重要,也是与波动方程的重要区别：

$$
\alpha_n=Dk_n^2
$$

## Laplace 方程（稳定问题）
### 方程非齐次（Poisson方程）
方程非齐次，边界齐次也可以存在非零解。
一般会取边界条件齐次，着重考查方程非齐次的处理方法。
#### 矩形齐次边界，非齐次方程（Poisson）


$$
\nabla^2 u=-f(x,y)
$$

$$
u|_{x=0}=u|_{x=a}=u|_{y=0}=u|_{x=b}=0
$$


这个问题的特殊之处在于，矩形区域的两个边界条件都是齐次的。这就说明，约束出来的子集，对于 $x$ 方向构成线性空间，对于 $y$ 方向也构成线性空间。这为定义两个线性映射，构造两个本征值问题，两套本征函数（一套二元本征函数）创造了条件。
* 通过对应的齐次的Laplace方程，寻找本征函数
  * 齐次Laplace方程，默认剩余边界条件（比如是 $y$ ）是非齐次
  * 这样可以找到一套本征函数，比如是关于 $x$ 的
  * 用这一套本征函数，对解和方程的非齐次项以及剩余边界条件（ $y$ 方向）同时做展开
  * 比对系数的过程，是求解关于 $y$ 的一系列非齐次ODE齐次边值问题的过程。
  * 当然，只需要求解通项公式就可以了，实际上只求解了一个非齐次ODE的边值问题。
* 通过对应的齐次的Helmholtz方程，寻找本征函数
  * 不应对于Helmholtz方程构成的本征值问题感到奇怪
    * 书上讲过作为本征函数的球谐函数
      * 球谐函数是二元函数
      * 对应的本征值问题是一个齐次PDE+齐次边界条件
    * 物理中也有许多波动方程、耗散方程
      * 当这些PDE是齐次方程，关于时间的初始条件非齐次，关于空间的边界条件全部其次的时候（只有初始条件非齐次）
      * 这个时候，分离出时间变量，余下的空间部分（可以不止一维）都是构成了Helmholtz方程的本征值问题
    * Helmholtz方程的本征值问题可以是多元的，不同的边界下，形式不一样
      * 矩形区域，是两个三角函数的乘积
        * 二维空间对应二元本征函数
        * 方便进行展开
      * 圆形区域，是Bessel函数和三角函数的乘积
        * 二维空间对应二元本征函数
        * 如果是柱形区域，则是Bessel函数和两个三角函数的乘积，但是本课程基本不涉及这种情况
        * 只考虑关于半径方向的一维，就是所谓的Bessel方程的本征值问题
        * 但是不方便进行展开
      * 球形区域，是球Bessel函数和两个三角函数的乘积，如果关于时间的初始条件关于 $z$ 轴具有旋转对称性，那么是球Bessel函数和一个三角函数的乘积。
        * 三维空间对应三元本征函数
        * 如果某一维度不起作用（具有对称性），则减少一元
        * 对于半径方向，可以展开
          * 最低阶尤其方便展开，等价于三角函数展开，很有可能会考
        * 对于角度方向，也可以展开
          * 这是Legendre函数的展开
  * 这样可以得到，一套二元的本征函数组，做展开的时候也是对二元函数的展开。
    * 对 $x$ 展开的时候把 $y$ 视作常数，反之亦然。
* 对比分析
  * 单纯论展开，只要取一组完备正交基底就可以了
  * “基底展开，代入方程，比较系数”是PDE级数解法的核心思想
  * 为了使得“比较系数”这一步可行，需要线性映射/线性微分算子作用后，基底仍然是基底
  * 这就要求选取的基底是特征向量/本征函数
  * 但是，对于一个PDE方程，把哪一部分视作线性映射，提取一个一维空间的线性映射还是一个二维空间的线性映射......这些问题是具有灵活性的
  * 正是因为提取的线性映射不同，造成了展开过程的基底选择可以不同。
#### 球形齐次边界，非齐次方程（Poisson）

$$
\nabla^2 u=f(r,\theta,\phi)
$$
$$
u|_{x=r}=0
$$

* 这是书上例题，本质和前面的问题相同
* 通过对应的齐次的Laplace方程，寻找本征函数
  * 齐次Laplace方程默认关于 $r$ 方向边界条件是非齐次
  * 所以 $\theta,\phi$ 方向构成本征值问题，本征函数是二元的球谐函数。
  * 比较系数的过程，是求解关于 $r$ 的一系列非齐次ODE边值问题的过程（实际上是Euler方程）
  * 最一般的情况下，本征函数是二元的，并且存在简并现象。非本征值问题齐次通解也有两个基底，所以要梳理好层次关系（一般把叠加系数都堆到非本征值问题的基底上去）：

如果是齐次方程，有下面的式子：

$$
u(r,\theta,\phi)=\sum_{l=0}^{+\infty}\sum_{m=0}^{l}(C_{1lm}r^{l}+D_{2lm}r^{-l-1})P_l^m(\cos \theta)\cos(m\phi)+\sum_{l=0}^{+\infty}\sum_{m=1}^{l}(Cr^{l}+Dr^{-l-1})P_l^m(\cos \theta)\sin(m\phi)
$$

但对于非齐次方程， $R_{1lm}(r),R_{2lm}(r)$ 满足的是一系列非齐次的ODE的边值问题：

$$
u(r,\theta,\phi)=\sum_{l=0}^{+\infty}\sum_{m=0}^{l}R_{1lm}(r)P_l^m(\cos \theta)\cos(m\phi)+\sum_{l=0}^{+\infty}\sum_{m=1}^{l}R_{2lm}(r)P_l^m(\cos \theta)\sin(m\phi)
$$

如果具有对称性，可以简化上面的式子。


* 通过对应的齐次的Helmholtz方程，寻找本征函数
  * 本征函数是三元的
  * 径向方向是作为本征函数的球Bessel函数
  * 这个会比前一种方法多一层展开
  * 但是比较系数的过程是解一系列代数方程
  * 如果说，非齐次项与 $\theta,\phi$ 均无关，这时径向的本征函数是 $j_0$ 这还是很好做展开的。
  * 其他情况，只能寄希望于，方程的非齐次项已经展开好了。
#### 圆形齐次边界，非齐次方程（Poisson）

$$
\nabla^2 u=f(r,\theta)
$$
$$
u|_{x=r}=0
$$

* 这是和上面是一脉相承的
* 但是通过Helmholtz方程本征值问题，寻找本征函数实际上是不太好的，因为作为本征函数的Bessel函数时没有解析表达式的，也不太好展开。
* 如果通过对应的齐次Laplace方程寻找本征函数倒是很简单的
### 方程齐次（真正的Laplace）
方程非齐次，不含初始条件，那么一定有一个剩余边界条件非齐次。这有这样，才会存在非零解。
#### 矩形边界，一个齐次，一个非齐次，方程齐次
* 书p225/5
* 拿齐次边界构成的本征值问题中的本征函数做基底
* 把解用这组基底，形式上展开
* 代入PDE，匹配系数，得到一系列的齐次ODE
* 展开非齐次的剩余边界条件
* 展开系数为这一系列的齐次ODE提供了一系列边值条件
* 求解一系列ODE边值问题，代入解式
* 完成
#### 环形边界，半径方向非齐次
* 在极坐标系下，角度方向还是齐次的，而且永远是齐次的周期性边界条件（当然，不能是扇形）。
* 所以取角度方向的本征值问题的本征函数做基底
* 形式上展开解
* 代回PDE方程，得到一系列齐次ODE
* 求通解，相当于是在求解Euler方程
* 用角度方向的本征函数展开内外半径的非齐次边界条件
* 得到的一系列系数，成为了一系列齐次ODE的边值条件
* 利用一系列ODE边值条件，确定一些列ODE通解的系数
* 代回解式
* 完成
#### 球形边界，半径方向非齐次
* 在球坐标系下，角度方向总是齐次的边界条件
  *  $\theta$ 方向是有界的齐次边界条件
  *  $\phi$ 方向是周期性齐次边界条件
* 根据给出的半径方向边界条件是否与 $\theta,\phi$ 有关，可以从对称性角度，减少本征函数的数量。
* 有的时候，即便是半球，也没有什么不同
  * 比如 $\theta=\frac{\pi}{2}$ 的时候是 $0$ ，那么也不改变本征函数。
## 波动方程
### 一维齐次波动方程，边界条件非齐次
* 级数解法
  * 边界条件齐次化，尽量同时齐次化
  * 构造本征值问题，寻找本征函数做基底
  * 形式上展开解式，代回方程，得到一系列关于时间的ODE
  * 展开初始条件，展开系数提供了一系列ODE的初始条件
  * 求解一系列ODE初值问题，代入解式
  * 完成
* 有界区域使用Laplace变换法
  * 这是可以尝试的
### 圆形齐次边界条件，非齐次方程（受迫振动）
* 先通过对应的齐次方程，寻找本征函数作为基底
  * 一般的情形是有两套本征函数（二元本征函数），写成级数解也是二重级数
  * 如果初始条件与角度无关，则简化为一套本征函数（一元本征函数），写成级数解是一重级数
* 用这组基底，形式上展开解式
* 同样用这组基底，展开方程的非齐次项
  * 难点在于用Bessel函数做展开
* 比对系数，得到一系列关于时间的非齐次ODE
* 展开初始条件，得到一系列关于时间的初值
* 求解一系列的非齐次ODE初值问题，代回解式，完成
### 圆形齐次边界条件，齐次方程，非齐次初始条件
* 解法与上面类似
* 区别在于：
  * 求解一系列齐次的ODE初值问题
  * 不用对方程的非齐次项做展开
  * 仍要对初始条件做展开
### 球形齐次边界条件，齐次方程，非齐次初始条件
这样的问题和圆形区域类似，主要的区别如下：
* 径向上的本征函数是作为本征函数的球Bessel函数
*  $\theta$ 方向的本征函数的连带Legendre函数
*  角度方向上的本征函数，合起来是球谐函数
  
有一些特别简单的情况如下：
* 当初始条件只与 $r$ 有关，那么本征函数是一元的，只有径向部分
  
$$
j_0(k_nr)=j_0(\frac{n\pi}{a}r)=\frac{\sin(\frac{n\pi}{a}r)}{\frac{n\pi}{a}r}
$$

* 当初始条件只与 $\phi$ 有关，那么本征函数是一元的，只有 $\phi$ 角度的三角函数部分

$$
\sin(m\pi\phi)
$$

$$
\cos(m\pi\phi)
$$

* 当初始条件只与 $r,\phi$ 有关，那么本征函数是二元的，只有 $\phi$ 角度的三角函数部分，以及径向的球Bessel函数

$$
\sin(m\pi\phi)
$$

$$
\cos(m\pi\phi)
$$

$$
j_0(k_nr)=j_0(\frac{n\pi}{a}r)=\frac{\sin(\frac{n\pi}{a}r)}{\frac{n\pi}{a}r}
$$

最一般的本征函数是三元的：

$$
\sin(m\pi\phi)
$$

$$
\cos(m\pi\phi)
$$

$$
P_l^m(\cos(\theta))
$$

$$
j_l(k_{mi}r)
$$

$m,l,i$ 三个指标分别用来对三个不同的本征值计数。

### 球形齐次边界条件，非齐次方程（受迫振动）
这和上面的问题基本是一样的，只不过还要对方程的非齐次项做展开。以及匹配系数的过程，对于时间是一系列非齐次的ODE。

## 耗散方程
### 一维齐次耗散方程，边界条件非齐次

$$
\frac{\partial}{\partial t}u-\kappa\frac{\partial^2}{\partial x^2}u=0
$$

$$
u|_{x=0}=f(t)
$$

* 级数解法
  * 边界条件齐次化，尽量同时齐次化
  * 构造本征值问题，寻找本征函数做基底（求解ODE的边值问题）
  * 形式上展开解式，代回方程，得到一系列关于时间的ODE
  * 展开初始条件，展开系数提供了一系列ODE的初始条件
  * 求解一系列ODE初值问题，代入解式
  * 完成
* 有界区域可以尝试Laplace变换法
  * 可以尝试，但是
  * 但是，反演可能很成问题
### 球形齐次边界，齐次方程，非齐次初始条件
这和波动方程对应形式的问题没什么本质区别。它们选取的本征函数都是一样的，选取本征函数，依据对称性删减本征函数的原则也是一样的。

区别主要在于，匹配系数的过程，得到的关于时间的一系列ODE是一阶的，而不是二阶的。
> 如果方程也是非齐次，用同样的本征函数对方程非齐次项做展开就好了。匹配系数得到的一系列ODE也变成了非齐次的ODE，区别不大，不再单独讨论。
### 圆形齐次边界，齐次方程，非齐次初始条件
* 时间部分构成非本征值问题，基底是指数函数（衰减）
* 空间部分整体构成本征值问题（Helmholtz本征值问题），本征函数是作为本征函数的球Bessel函数和三角函数的乘积
* 用二元本征函数（空间部分），形式上展开解式
* 代入PDE方程，比对系数（时间部分）
* 构成了一系列齐次的ODE，其齐次通解基底就是衰减的指数函数
* 用二元本征函数展开初始条件，展开系数作为一系列ODE初值问题的初始条件
* 求解一系列ODE的初值问题，代回解式，完成
* 难点在于：
  * 圆形边界Helmholtz方程本征值问题，二元本征函数的层次关系
    * 以及只保留 $J$ 而舍弃 $N$ 的原因是 $r=0$ 有界。如果是圆环的话，会更复杂，因为还要保留 $N$ 。这意味着级数阶形式上要写成四项（这根本不可能考）。
  * 用作为本征函数的Bessel函数展开非齐次的初始条件

$$
u(r,\theta,t)=\sum_{i=1}^{+\infty}\sum^{+\infty}_{m=0}C_{mi}T_{1mi}(t)J_m(k_{mi}r)\cos(m\theta)+\sum_{i=1}^{+\infty}\sum^{+\infty}_{m=1}D_{mi}T_{2mi}(t)J_m(k_{mi}r)\sin(m\theta)
$$

上面的 $k_{mi}=\mu ^{(m)} _i/a$ ,其中的 $\mu_i^{(m)}$ 是 $m$ 阶Bessel函数的第 $i$ 个零点。 $m$ 和第一个本征值相关， $i$ 和第二个本征值相关。
> 如果方程也是非齐次，用同样的本征函数对方程非齐次项做展开就好了。匹配系数得到的一系列ODE也变成了非齐次的ODE，区别不大，不再单独讨论。
## 本征函数展开非齐次项（方程、初始条件/剩余边界条件）的技巧
### 三角函数做基底
* 展开幂函数，要多次分部积分。展开多项式亦然。
* 展开正余弦，要和差化积，直接积分
* 展开双曲正余弦，要首先化成正余弦（提出一个虚数单位），然后和差化积，直接积分
### 作为本征函数的Bessel函数做基底
* 适用于波动方程/耗散方程，圆形边界。
* 作为本征函数的Bessel函数的模平方的计算是一个难点，好在老师会给公式
  * 但是老师给的公式是不定积分公式
  * 并且用 $x$ 表示
  * 使用的时候要换元， $x=k_{mi}r$ ，并且取定积分
* 作为本征函数的Bessel函数对非齐次项的展开
  * **千万不要忘记权函数** $r$ 
  * 对多项式的展开，拆分成对幂函数的展开
  * 通过幂函数的幂次与Bessel函数的阶数判断
    * 是否可以展开
    * 如何选择递推公式，进而选择分部积分路径
    * 这个问题在另外一个文档，Series Solutions of PDEs，里面详细讨论过了
### 作为本征函数的零阶球Bessel函数做基底
* 适用于波动方程/耗散方程，球形边界，定解条件与 $\theta$ 无关的情形

### Legendre 函数做基底
* 我觉得这个问题大概率会通过求解积分式的方式直接考查。
* 这里就不多说了

# 旧瓶新酒
* Laplace 边界条件
  * 可以是球内也可以是球外
    * 定解问题 $r$ 方向的适用区域
  * 可以是圆形也可以是扇形
    * $\theta$ 方向的边界
  * 可以是圆盘也可以是圆环
    * $r$ 方向的边界
* 可以用Laplace变换解决的问题，有时也可以用Fourier变换求解，反之亦然


# 需要关注的细节
* 内积的权函数，尤其是Bessel函数
* 本征值，本征函数， $n=0,1,2,3,...$ 本征值可否为 $0$ 以及角标可否为 $0$ 可否为负整数（一般不可以）
* 注意区分本征值 $\lambda_n$ 与本征值的计数角标 $n$
* 半整数通分分母不要丢掉
* 物理上，策动力频率和某个本征频率相符合，则会产生共振。反应在数学上，方程的非齐次项如果和本征值重叠，需要对级数解中相应本征值的项，运用l'Hospital法则，注意是 $\omega\to\omega_n$ 后者和本征值对于，离散取值，前者和方程非齐次项对于（策动力）连续取值。求导是对 $\omega$ 的求导。最终结果往往可以看出，振幅对 $t$ 是无界的，随时间增大的。
* 球形边界/圆形边界 变量分离形式的 $R$ 方程和Euler方程有重大区别。
  * 对于圆形边界，由变量分离的径向约束的标准形式，要乘以 $r^2$ 才能得到Euler方程。这时就要注意，方程的非齐次项也要乘以 $r^2$ !!!
  * 由 $R$ 维度的标准方程，化为Euler方程的时候，两侧同时乘以 $r^2$ 
  * PDE方程非齐次项，展开匹配系数得到的是 $R$ 维度的标准方程的非齐次项，而不是Euler方程的非齐次项!!!
    * 当然这个问题只有当PDE方程非齐次，边界时圆形的时候才会带来隐患
  * 注意积分限是否与熟知的公式相一致
    * Legendre内积的积分限： $\int_{-1}^{1}$
      * 变体： $\int_{0}^{1}$
    * Laplace变换的积分限： $\int_{0}^{+\infty}$
      * 变体： $\int_{-\infty}^{+\infty}$
    * 否则需要运用对称性转化
  * 关于本征值是否可以取 $0$ 的讨论是很必要的